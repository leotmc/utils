## 层级分类模型

[toc]

通过分析诉求数据可知，诉求事件类别的标签体系并非扁平展开的标签体系，而是一个分层级的标签体系：

<img src="/Users/leotmc/complaints.png" alt="complaints" style="zoom:80%;" />

基于传统的分类模型难以捕捉类别之间的层级及相邻的关系，层级分类模型通过刻画类别标签之间的语义相关性以及层级关系，可以更好地完成分类任务。

### HiMatch层级分类模型

<img src="/Users/leotmc/HiMatch.jpg" alt="HiMatch" style="zoom:80%;" />

#### 文本及其对应的标签的联合表征学习

​		首先通过文本编码器和标签编码器提取文本和标签的语义表征，然后将文本语义表征和标签语义表征投影到一个联合的向量空间，通过联合向量之间的损失函数使文本及其对应的标签在语义上相似。

- 文本及标签编码器

  将文本输入到Bi-GRU进行字的表征学习；然后使用CNN + k-max pooling方法抽取文本特征，最后使用Feature Propagation模块将学习的特征与标签体系的先验信息进行交融学习，得到最终的文本表征向量$$S_t$$和标签的表征向量$S_l$。

  Feature Propagation将类别标签构成一个有向图，将类别间的层级信息以及类别之间的相关信息融合到表征向量中。

- 联合表征学习

  通过两个独立的全连接层将$S_t$和$S_l$投影到一个共同的隐空间，即：

  ​																				$\Phi_{t}=FFN_{t}(S_{t})$

  ​																				$\Phi_{l}=FFN_{l}(S_{l})$

  使用最小二乘损失来对齐文本和标签在隐空间的表征，即：

  ​																	$L_{joint}=\sum_{p\in P(y)}||\Phi_{t}-\Phi_{l}^{p}||_{2}^{2}$

#### 匹配学习

匹配学习的目标是希望表征的文本向量不仅要与对应真实标签向量越近越好，还要与非真实标签向量越远越好，HiMatch匹配损失函数使得文本与其对应的标签之间的语义相似，同时与不相关的标签之间语义不相似，具体损失函数为：

​																$L_{match}=max(0,D(\Phi_{t},\Phi_{l}^{p})-D(\Phi_{t},\Phi_{l}^{n})+\gamma)$

其中$\Phi_{l}^{p}$为正确标签的语义表征，$\Phi_{l}^{n}$为不相关的标签的语义表征，$D(\Phi_{t},\Phi_{l})$为文本和标签之间在语义表征上的距离。

#### 总体损失函数

HiMatch的最终损失函数由三部分构成，即：

​															$$L=L_{cls}(y,\hat y) + \lambda_{1}L_{joint} + \lambda_{2}L_{match}$$

其中$L_{cls}$为真实样本和预测样本之间的交叉熵损失，$L_{joint}$为联合表征学习损失函数，$L_{match}$为匹配学习额损失函数。

